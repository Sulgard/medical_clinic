<div class="container-fluid d-flex justify-content-center align-items-center vh-100">

  <mat-card class="health-details-card">
    <button mat-stroked-button color="accent" (click)="navigateToPatients()">
      Back to Patients
    </button>
    <mat-card-header class="d-flex justify-content-between align-items-center">
      <mat-card-title>Health Details</mat-card-title>
      <button mat-icon-button (click)="toggleEdit()">
        <mat-icon>{{ isEditing ? 'check' : 'edit' }}</mat-icon>
      </button>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]="healthDetailsForm">
        <div *ngIf="!isEditing">
          <p><strong>Blood Type:</strong> {{ healthDetails?.bloodType }}</p>
          <p><strong>Allergies:</strong> {{ healthDetails?.allergies }}</p>
          <p><strong>Chronic Conditions:</strong> {{ healthDetails?.chronicConditions }}</p>
          <p><strong>Medications:</strong> {{ healthDetails?.medications }}</p>
          <p><strong>Emergency Contact Name:</strong> {{ healthDetails?.emergencyContactName }}</p>
          <p><strong>Emergency Contact Phone Number:</strong> {{ healthDetails?.emergencyContactPhone }}</p>
        </div>
        <div *ngIf="isEditing">
          <mat-form-field appearance="fill" class="w-100 mb-3">
            <mat-label>Blood Type</mat-label>
            <input matInput formControlName="bloodType" />
            <mat-error *ngIf="healthDetailsForm.get('bloodType')?.hasError('required')">
              Blood Type is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100 mb-3">
            <mat-label>Allergies</mat-label>
            <input matInput formControlName="allergies" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100 mb-3">
            <mat-label>Chronic Conditions</mat-label>
            <input matInput formControlName="chronicConditions" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100 mb-3">
            <mat-label>Medications</mat-label>
            <input matInput formControlName="medications" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100 mb-3">
            <mat-label>Emergency Contact Name</mat-label>
            <input matInput formControlName="emergencyContactName" />
            <mat-error *ngIf="healthDetailsForm.get('emergencyContactName')?.hasError('required')">
              Emergency Contact Name is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-100 mb-3">
            <mat-label>Emergency Contact Phone Number</mat-label>
            <input matInput formControlName="emergencyContactPhone" />
            <mat-error *ngIf="healthDetailsForm.get('emergencyContactPhone')?.hasError('required')">
              Phone number is required
            </mat-error>
            <mat-error *ngIf="healthDetailsForm.get('emergencyContactPhone')?.hasError('pattern')">
              Please enter a valid phone number
            </mat-error>
          </mat-form-field>

          <div class="text-center mt-3">
            <button mat-raised-button color="primary" (click)="saveChanges()">Save</button>
          </div>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
